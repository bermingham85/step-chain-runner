{
  "project_name": "wellybox-receipt-intake",
  "workflow_graph": {
    "nodes": [
      {"id": "ingest_input", "type": "start", "description": "Receive webhook JSON"},
      {"id": "normalize_payload", "type": "process", "description": "Flatten fields, handle batch"},
      {"id": "enrich_metadata", "type": "process", "description": "Add receipt_id, hash, timestamp"},
      {"id": "run_external_integrations", "type": "integration", "description": "Google Sheets append with header expansion"},
      {"id": "compare_or_validate", "type": "decision", "description": "OCR2 comparison with tolerance rules"},
      {"id": "route_status", "type": "decision", "description": "READY_FOR_REVIEW vs HOLD_REVIEW"},
      {"id": "write_outputs", "type": "integration", "description": "Update sheet with status"},
      {"id": "finalize", "type": "end", "description": "Return result"}
    ],
    "edges": [
      {"from_node": "ingest_input", "to_node": "normalize_payload"},
      {"from_node": "normalize_payload", "to_node": "enrich_metadata"},
      {"from_node": "enrich_metadata", "to_node": "run_external_integrations"},
      {"from_node": "run_external_integrations", "to_node": "compare_or_validate"},
      {"from_node": "compare_or_validate", "to_node": "route_status"},
      {"from_node": "route_status", "to_node": "write_outputs"},
      {"from_node": "write_outputs", "to_node": "finalize"}
    ]
  },
  "state_schema": "from typing import TypedDict, List, Dict, Any, Optional\n\nclass WorkflowState(TypedDict):\n    raw_input: str\n    items: List[Dict[str, Any]]\n    canonical_record: Optional[Dict[str, Any]]\n    diff: Optional[Dict[str, Any]]\n    status: str\n    errors: List[str]\n    outputs: Dict[str, Any]",
  "file_tree": [
    "wellybox-receipt-intake/",
    "wellybox-receipt-intake/README.md",
    "wellybox-receipt-intake/requirements.txt",
    "wellybox-receipt-intake/.env.example",
    "wellybox-receipt-intake/main.py",
    "wellybox-receipt-intake/graph.py",
    "wellybox-receipt-intake/state.py",
    "wellybox-receipt-intake/nodes/",
    "wellybox-receipt-intake/nodes/ingest.py",
    "wellybox-receipt-intake/nodes/normalize.py",
    "wellybox-receipt-intake/nodes/validate.py",
    "wellybox-receipt-intake/adapters/",
    "wellybox-receipt-intake/adapters/google_sheets.py",
    "wellybox-receipt-intake/tests/",
    "wellybox-receipt-intake/examples/test_payload.json"
  ],
  "files": {
    "README.md": "# wellybox-receipt-intake\n\nProcess WellyBox receipts with OCR validation.\n\nGenerated by LangChain Creator System.",
    "requirements.txt": "langchain\nlanggraph\nfastapi\nuvicorn\npydantic\ngspread\noauth2client",
    ".env.example": "GOOGLE_SERVICE_ACCOUNT_JSON=path/to/credentials.json\nGOOGLE_DRIVE_FOLDER_ID=your_folder_id\nSHEET_NAME=receipts",
    "state.py": "# WorkflowState Pydantic model",
    "graph.py": "# LangGraph implementation with 8 nodes",
    "main.py": "# FastAPI webhook server",
    "adapters/google_sheets.py": "# Google Sheets integration with dynamic header expansion"
  },
  "env_vars": [
    "GOOGLE_SERVICE_ACCOUNT_JSON",
    "GOOGLE_DRIVE_FOLDER_ID",
    "SHEET_NAME"
  ],
  "run_commands": [
    "pip install -r requirements.txt",
    "uvicorn main:app --reload --port 8000",
    "curl -X POST http://localhost:8000/webhook/wellybox -d @examples/test_payload.json"
  ],
  "tests": [
    "pytest tests/test_workflow.py",
    "Test header expansion with new fields"
  ],
  "limitations": [
    "Template-based generation; customize for production",
    "Google Sheets API rate limits apply",
    "OCR comparison assumes structured input"
  ]
}
